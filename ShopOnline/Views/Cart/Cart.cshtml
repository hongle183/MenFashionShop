@using ShopOnline.Models
@model List<Cart>
@{
    ViewBag.Title = "Giỏ hàng";
    Layout = "~/Views/Shared/_LayoutPublicPage.cshtml";
}

<!-- Breadcrumb Section Begin -->
<section class="breadcrumb-option">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="breadcrumb__text">
                    <h4>@ViewBag.Title</h4>
                    <div class="breadcrumb__links">
                        <a href="/trang-chu">Trang chủ</a>
                        <a href="/san-pham">Shop</a>
                        <span>@ViewBag.Title</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- Breadcrumb Section End -->
<!-- Shopping Cart Section Begin -->
<section class="shopping-cart spad">
    <div class="container">
        @if (Model.Count > 0)
        {
            <div class="row" id="listCartContainer">
                @Html.Partial("_ListItem", Model)
            </div>
        }
        else
        {
            <div class="shopping__cart__table text-center">
                <img src="~/Content/img/Orders/empty.png" alt="" style="width:30%;" />
                <h3 class="my-3">Không có sản phẩm nào trong giỏ hàng!!</h3>
                <a class="outline-btn btn" href="/san-pham">Tiếp tục mua sắm</a>
            </div>
        }
    </div>
</section>
<!-- Shopping Cart Section End -->
<script>
    var obj = document.querySelector(".navbar li:nth-child(1)");
    obj.classList.remove("active");

    $(document).on('input', '#quantity', function () {
        this.value = this.value.replace(/[^0-9]/g, '');
        if (this.value === '' || parseInt(this.value) < 1) {
            this.value = 1;
        }
    });

     // Category add cart with AJAX
    $(document).on("click", "#delete-cart", function (e) {
        e.preventDefault();
        var id = $(this).data("id");

        $.ajax({
            url: '@Url.Action("DeleteCart", "Cart")',
            type: 'POST',
            data: { id },
            success: function (res) {
                $("#listCartContainer").html(res);
                // Sau khi thêm thành công, cập nhật lại phần navbar
                $(".header__nav__option").load("/Cart/Navbar");
            },
            error: function (err) {
                console.log(err.responseText);
            }
        });
    });
</script>
