@model ShopOnline.Models.Product
@{
    ViewBag.Title = Model.productName;
    Layout = "~/Views/Shared/_LayoutPublicPage.cshtml";
}
<!-- Shop Details Section Begin -->
<section class="shop-details">
    <div class="product__details__pic">
        <div class="container">
            <!-- Breadcrumb Section Begin -->
            <div class="row pb-4">
                <div class="col-lg-12">
                    <div class="breadcrumb__text">
                        <h4>Chi tiết sản phẩm</h4>
                        <div class="breadcrumb__links">
                            <a href="/trang-chu">Trang chủ</a>
                            <a href="/san-pham">Shop</a>
                            <span>@Model.productName</span>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Breadcrumb Section End -->
            <div class="row">
                <div class="col-lg-2 col-md-3">
                    <ul class="nav nav-tabs" role="tablist">
                        <li class="nav-item">
                            <a class="nav-link active" data-toggle="tab" href="#tabs-1" role="tab">
                                <div class="product__thumb__pic set-bg" data-setbg=@Url.Content("" + @Model.image)>
                                </div>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" data-toggle="tab" href="#tabs-2" role="tab">
                                <div class="product__thumb__pic set-bg" data-setbg=@Url.Content("" + @Model.image)>
                                </div>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" data-toggle="tab" href="#tabs-3" role="tab">
                                <div class="product__thumb__pic set-bg" data-setbg=@Url.Content("" + @Model.image)>
                                </div>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" data-toggle="tab" href="#tabs-4" role="tab">
                                <div class="product__thumb__pic set-bg" data-setbg=@Url.Content("~/Content/img/shop-details/thumb-4.png")>
                                    <i class="fa fa-play"></i>
                                </div>
                            </a>
                        </li>
                    </ul>
                </div>
                <div class="col-lg-4 col-md-9">
                    <div class="tab-content">
                        <div class="tab-pane active" id="tabs-1" role="tabpanel">
                            <div class="product__details__pic__item">
                                <img src=@Url.Content("" + @Model.image) alt="">
                            </div>
                        </div>
                        <div class="tab-pane" id="tabs-2" role="tabpanel">
                            <div class="product__details__pic__item">
                                <img src=@Url.Content("" + @Model.image) alt="">
                            </div>
                        </div>
                        <div class="tab-pane" id="tabs-3" role="tabpanel">
                            <div class="product__details__pic__item">
                                <img src=@Url.Content("" + @Model.image) alt="">
                            </div>
                        </div>
                        <div class="tab-pane" id="tabs-4" role="tabpanel">
                            <div class="product__details__pic__item">
                                <img src="~/Content/img/shop-details/product-big-4.png" alt="">
                                <a href="https://www.youtube.com/watch?v=8PJ3_p7VqHw&list=RD8PJ3_p7VqHw&start_radio=1" class="video-popup"><i class="fa fa-play"></i></a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-6">
                    <div class="product__details__text">
                        <h4>@Model.productName</h4>
                        <div class="rating">
                            <i class="fa fa-star"></i>
                            <i class="fa fa-star"></i>
                            <i class="fa fa-star"></i>
                            <i class="fa fa-star"></i>
                            <i class="fa fa-star-o"></i>
                            <span> - 5 đánh giá</span>
                        </div>
                        @{
                            if (Model.discount != 0)
                            {
                                <div class="h3">
                                    @String.Format("{0:#,0}", ViewBag.NewPrice)₫
                                    <span>@String.Format("{0:#,0}", Model.price)₫</span>
                                    <p style="font-size: 23px; color: red;">Giảm @Model.discount%</p>
                                </div>
                            }
                            else
                            {
                                <div class="h3">$@Model.price</div>
                            }
                            var charac = Model.characteristic.Split(',');
                            <div>
                                <table class="table table-borderless">
                                    <tbody>
                                        @foreach (var i in charac)
                                        {
                                            var temp = i.Trim().Split(':');
                                            <tr style="display:inline-block; width:50%; float:left;">
                                                <th class="text-left p-1" style="min-width:130px; width:fit-content;" scope="row">• @temp[0].Trim()</th>
                                                <td class="text-left p-1">@temp[1].Trim()</td>
                                            </tr>
                                        }
                                    </tbody>
                                </table>
                            </div>
                        }
                        <div class="product__details__option">
                            <div class="product__details__option__size">
                                <span>Size:</span>
                                <label for="xxl">
                                    xxl
                                    <input type="radio" id="xxl">
                                </label>
                                <label for="xl">
                                    xl
                                    <input type="radio" id="xl">
                                </label>
                                <label for="l">
                                    l
                                    <input type="radio" id="l">
                                </label>
                                <label class="active" for="sm">
                                    s
                                    <input type="radio" id="sm">
                                </label>
                                <label for="m">
                                    m
                                    <input type="radio" id="m">
                                </label>
                            </div>
                            <div class="product__details__option__color">
                                <span>Màu sắc:</span>
                                <label class="c-1" for="sp-1">
                                    <input type="radio" id="sp-1">
                                </label>
                                <label class="c-2" for="sp-2">
                                    <input type="radio" id="sp-2">
                                </label>
                                <label class="c-3" for="sp-3">
                                    <input type="radio" id="sp-3">
                                </label>
                                <label class="c-4" for="sp-4">
                                    <input type="radio" id="sp-4">
                                </label>
                                <label class="c-9" for="sp-9">
                                    <input type="radio" id="sp-9">
                                </label>
                            </div>
                        </div>
                        <div class="product__details__cart__option">
                            <div class="quantity">
                                <div class="pro-qty">
                                    <input type="text" value="1" id="quantity">
                                </div>
                            </div>
                            <a href="#"  data-id="@Model.productId" id="add-to-cart" class="site-btn btn">Thêm vào giỏ</a>
                        </div>
                        <div class="product__details__btns__option">
                            <a href="#"><i class="fa fa-heart"></i> Yêu thích</a>
                            <a href="#"><i class="fa fa-exchange"></i> So sánh ngay</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="product__details__content">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <div class="product__details__tab">
                        <ul class="nav nav-tabs" role="tablist">
                            <li class="nav-item">
                                <a class="nav-link active" data-toggle="tab" href="#tabs-5"
                                   role="tab">Chi tiết</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" data-toggle="tab" href="#tabs-6" role="tab">
                                    Đánh giá(5)
                                </a>
                            </li>
                        </ul>
                        <div class="tab-content">
                            <div class="tab-pane active" id="tabs-5" role="tabpanel">
                                <div class="product__details__tab__content">
                                    <div class="product__details__tab__content__item">
                                        @Html.Raw(Model.description)
                                    </div>
                                    <div class="product__details__tab__content__item text-center">
                                        <h5><span>Guaranteed Safe Checkout</span></h5>
                                        <img src="~/Content/img/vnpay.svg" alt="">
                                        <ul>
                                            <li><span>SKU:</span> 3812912</li>
                                            <li><span>Categories:</span> Clothes</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div class="tab-pane" id="tabs-6" role="tabpanel">
                                <div class="product__details__tab__content">
                                    <div class="product__details__tab__content__item text-center">
                                        <img src="~/Content/img/rating.png" alt="rating" />
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- Shop Details Section End -->
<!-- Related Section Begin -->
@Html.Action("RelationProduct", "Shop", new { product = Model.productId, category = Model.categoryId })
<!-- Related Section End -->

<script>
    var obj = document.querySelector(".navbar li:nth-child(1)");
    obj.classList.remove("active");
    var liTags = document.querySelectorAll('.navbar li');
    for (var i = 0; i < liTags.length; i++) {
        if (liTags[i].getAttribute('data-value') == "san-pham") {
            liTags[i].classList.add("active");
        }
    }

     // Category add cart with AJAX
    $(document).on("click", "#add-to-cart", function (e) {
        e.preventDefault();
        var id = $(this).data("id");
        var quantity = $(this).closest(".product__details__cart__option").find("#quantity").val() || 1;

        $.ajax({
            url: '@Url.Action("AddToCart", "Cart")',
            type: 'POST',
            dataType: 'json',
            data: { id, quantity },
            success: function (res) {
                if (res.success) {
                    // Sau khi thêm thành công, cập nhật lại phần navbar
                    $(".header__nav__option").load("/Cart/Navbar");
                }
            },
            error: function (err) {
                console.log(err.responseText);
            }
        });
    })
</script>
